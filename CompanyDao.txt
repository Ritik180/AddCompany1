package Recruitment.dao;
import Recruitment.dbutil.DBConnection;
import Recruitment.pojo.Company;
import Recruitment.pojo.Student;
import java.sql.*;
import java.util.*;
public class CompanyDao {
    public static boolean addCompany(Company c)throws SQLException
    {
        Connection conn=DBConnection.getConnection();
        PreparedStatement ps=conn.prepareStatement("insert into company values(?,?,?)");
        ps.setString(1,c.getCompName());
        ps.setDouble(2,c.getEligibility());
        ps.setString(3,c.getJob());
       
   int count= ps.executeUpdate();
   if(count==0)
       return false;
   else 
       return true;
}
 public static boolean removeCompany(String r)throws SQLException
    {
    Connection conn=DBConnection.getConnection();
        PreparedStatement ps=conn.prepareStatement("delete from company where company_name=?");
        ps.setString(1,r);
        int count=ps.executeUpdate();
        if(count==0)
        return false;
        else
        return true;
}
 public static ArrayList<Student> getCompany() throws SQLException
    {
        Connection conn=DBConnection.getConnection();
        String qry="Select * from company";
        Statement st=conn.createStatement();
        ResultSet rs=st.executeQuery(qry);
        ArrayList<Student>companyList=new ArrayList<Student>();
        while(rs.next())
        {
            Student s=new Student();
            s.setStream(rs.getString("company"));
            companyList.add(s);
        }
        return companyList;  
}
     public static ArrayList<Company> getAllData()throws SQLException{
       Connection conn=DBConnection.getConnection();
       String qry="Select company_name,eligibility,job from company";
       Statement st=conn.createStatement();
       ResultSet rs=st.executeQuery(qry);
       ArrayList<Company> compList=new ArrayList<>();
       while(rs.next()){
               Company c=new Company();
               c.setCompName(rs.getString("company_name"));
               c.setEligibility(rs.getDouble("eligibility_criteria"));
               c.setJob(rs.getString("job"));
               compList.add(c);
          }
       return compList;}
}